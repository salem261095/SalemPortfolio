---
import { ArrowLeft, ArrowRight } from "@lucide/astro";
import SecTitle from "./SecTitle.astro";
---

<section class="px-4 py-6" aria-label="شهادات العملاء">
  <SecTitle text="اراء العملاء" />
  <div class="relative overflow-hidden border rounded-lg p-6 bg-white">
    <div id="carousel" class="transition-all duration-300">
      <!-- Injected via JavaScript -->
    </div>

    <div class="flex justify-between mt-4">
      <button
        id="prev"
        class="border px-2 text-white py-1 bg-zinc-900 rounded-md"
      >
        <ArrowRight />
      </button>
      <button
        id="next"
        class="border px-2 text-white py-1 bg-zinc-900 rounded-md"
      >
        <ArrowLeft />
      </button>
    </div>
  </div>

  <script is:inline>
    const testimonials = [
      {
        quote:
          "تعاملت مع المصمم في تنفيذ هوية شركتي، والنتيجة فاقت التوقعات من حيث البساطة والاحترافية.",
        author: "خالد المريسي",
        position: "صاحب مشروع ناشئ",
      },
      {
        quote:
          "بنى لي موقع إلكتروني سريع ومتجاوب، وكان ملتزمًا بالمواعيد ويملك حسًا فنيًا عاليًا.",
        author: "منى العلوي",
        position: "مدربة أعمال حرة",
      },
      {
        quote:
          "تصميمات السوشيال ميديا كانت متناسقة مع علامتي وتعبّر بدقة عن رسالتي.",
        author: "أحمد عبدالكريم",
        position: "مسوّق رقمي",
      },
    ];

    let current = 0;
    const container = document.getElementById("carousel");

    const renderSlide = (index) => {
      const t = testimonials[index];
      container.innerHTML = `
        <div class="text-center space-y-4">
  <p class="text-lg leading-relaxed italic text-gray-700">“${t.quote}”</p>
  <div class="space-y-1">
    <p class="text-base font-bold text-zinc-800">${t.author}</p>
    <p class="text-sm text-gray-500">${t.position}</p>
  </div>
</div>

      `;
    };

    const nextSlide = () => {
      current = (current + 1) % testimonials.length;
      renderSlide(current);
    };

    const prevSlide = () => {
      current = (current - 1 + testimonials.length) % testimonials.length;
      renderSlide(current);
    };

    document.getElementById("prev").onclick = () => {
      prevSlide();
      resetTimer();
    };
    document.getElementById("next").onclick = () => {
      nextSlide();
      resetTimer();
    };

    let timer = setInterval(nextSlide, 5000);
    const resetTimer = () => {
      clearInterval(timer);
      timer = setInterval(nextSlide, 5000);
    };

    renderSlide(current);
  </script>
</section>
